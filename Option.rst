########
选项说明
########

所有选项都是可选的，默认只需要提供视频地址就可以了。

输入输出
========

输出文件
--------

命令行参数： ``-o/--output-filename FILENAME``

输出的 ass 字幕文件名，默认是视频的标题，如果没有 .ass 后缀，会自动添加。

如果是一个文件夹，则输出到该文件夹中。

创建播放列表
------------

命令行开关： ``-p/--create-playlist``

创建 m3u 播放列表文件，文件名和 ass 相同，只是扩展名为 m3u。

视频网址不支持此功能，则没作用。

弹幕选项
========

这部分选项和获取弹幕的行为有关，部分功能不是所有视频地址都支持。

辅助参数
--------

命令行参数： ``-a/--assist-params NAME1=1,NAME2=2``

手动指定无法直接获取的参数，用于辅助解析信息。

过滤文件
--------

命令行参数： ``-f/--custom--filter FILE``

关键词过滤文件，要求是 utf-8 编码的纯文本文件，每行一条正则，例如 ::

    最后
    结局
    ^剧透
    是凶手$

使用部分匹配，简单的关键词直接打上即可。

如果要完全匹配，可以和 ``^`` 或 ``$`` 配搭使用。

具体参考 Python 的 `正则文档`_ 。

.. _正则文档: http://docs.python.org/3.3/library/re.html

不要过滤底部弹幕
----------------

命令行开关： ``-B/--disable-bottom-filter``

默认是过滤的，启用此选项不过滤。

不要过滤游客弹幕
----------------

命令行开关： ``-G/--disable-guest-filter``

默认是过滤的，启用此选项不过滤。

视频网址不支持此功能，则没作用。

不要过滤云屏蔽的弹幕
--------------------

命令行开关： ``-G/--disable-video-filter``

默认是过滤的，启用此选项不过滤。

视频网址不支持此功能，则没作用。

跳过补丁
--------

命令行开关： ``-s/--skip-patch``

偏移弹幕的出现时间到正片的的位置。

视频网址不支持此功能，则没作用。

合并分段
--------

命令行开关： ``-m/--merge-parts``

下载所有分段的弹幕，并按该分段之前的视频长度自动偏移。

视频网址不支持此功能，则没作用。

字幕选项
========

这部分选项和输出 ass 字幕文件有关，详细作用请自行搜索 ass 的规格。

命令行短选项格式都以 ``+`` 符号开头。

分辨率
------

命令行参数： ``+r/--play-resolution WIDTHxHEIGHT``

也就是 ass 格式中的开头的 ``PlayResX`` 和 ``PlayResY`` 的值，不需要跟视频实际分辨率一致，播放器会执行缩放。

字体名称
--------

命令行参数： ``+f/--font-name NAME``

即是 ass 格式中的 ``Style:`` 行的字体名称。

默认自动判断，Windows 系统使用微软雅黑，非 Windows 系统使用文泉驿微米黑。

字体大小
--------

命令行参数： ``+s/--font-size SIZE``

即是 ass 格式中的 ``Style:`` 行的字体大小。

此为基准大小，即为原弹幕中的默认中号字体，大号和小号字体和会按此大小自动作相应的增减。

限制行数
--------

命令行参数： ``+l/--line-count COUNT``

限制弹幕在上/下方几行，以免遮挡大部分画面。

如果为 0，则表示全屏，自动根据字体大小来算出最大行数。

布局算法
--------

命令行参数： ``+a/--layout-algorithm sync|async``

自带两种布局算法

* 速度同步 每一条滚动弹幕的移动速度都是相同的，避免弹幕重叠，容易看清弹幕内容，比较适合看剧集类的视频。

* 速度异步 弹幕滚动速度取决于它的长度范围，可能在快移出时重叠，看上去比较有节奏感，比较适合看 MTV 类的视频。

因为是布局算法只是模拟出来，还有每种字体的字符实际可见宽度也未必等宽，所以和播放器实际效果不能完全相同。

微调时长
--------

命令行参数： ``+t/--tune-duration SECONDS``

如果感觉弹幕滚动得过快或者过慢，可以调整此参数，显示时间多加多少秒，正数为减慢，负数为加快。

丢弃偏移
--------

命令行参数： ``+d/--drop-offset SECONDS``

因为避免弹幕重叠而使用了碰撞算法，总会有些时间点因为密度过大，而造成某些弹幕没有空位放下。因此需要延迟一下出现时间，这个参数就是允许延迟的最大长度，如果超过 N 秒都没有空位放下，那么这条弹幕就会被丢弃掉。

如果为 0，则表示不做延迟，马上丢弃掉。

这个参数无论是何值，都完全不影响转换效率。

底部边距
--------

命令行参数： ``+b/--bottom-margin HEIGHT``

设置底部弹幕的边距，为了避免遮挡视频本身的对白字幕。

自定偏移
--------

命令行参数： ``+b/--bottom-margin LENGTH``

如果字幕时间轴不合你的片源，则可以用这个选项整体偏移所有 ass 字幕行的时间轴。

这在跳过补丁、合并分段、丢弃偏移后执行，和输出 ass 文件后再用其它 ass 编辑器来做偏移效果相同。

但这里可以使用更方便的 HH:MM:SS 的格式，同时也支持表达式计算，例如下面表示往后偏移两分钟 ::

    120
    00:120
    00:00:120
    2:00
    02:00
    00:02:00
    4:00-2:00
    62:00-60:00
    100:02:00-100:00:00
    -2:00+4:00
    30+30+30+30
    4:00-60-60

如果往前偏移，则结果需要是一个负数。

如果在命令行输入负数，因为以 ``-`` 开头会被当成选项解析，因此需要在前面加零来避免，例如 ``0-2:00`` 。

样式模板
--------

命令行参数： ``+h/--header-file FILE``

自定义 ass 文件头的样式模板，默认是是程序根目录下的 niconvert/libass/header.tpl，可以复制一份来修改。

以下占位符会根据选项值自动替换

* ``{width}`` ``{height}`` 分辨率

* ``{fontname}`` 字体名称

* ``{fontsize}`` 字体大小

但是 ``Style:`` 行中的格式名必须是 ``Danmaku`` 。

